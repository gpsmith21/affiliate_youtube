Test 1:  Load commissions data for year 2023, effective 2025-09-02. Ensure this data is loaded.
Number of rows:
 num_rows 
----------
      767
(1 row)

Latest refresh date by event year:
 event_year | latest_refresh_date 
------------+---------------------
       2023 | 2025-09-02
(1 row)

Test 2: Load commissions data for year 2023, effective 2025-09-01. Ensure this new data was not loaded.
Number of rows:
 num_rows 
----------
      767
(1 row)

Latest refresh date by event year:
 event_year | latest_refresh_date 
------------+---------------------
       2023 | 2025-09-02
(1 row)

Test 3: Load commissions data for year 2023, effective 2025-09-03. Ensure old data was overwritten.
Number of rows:
 num_rows 
----------
      767
(1 row)

Latest refresh date by event year:
 event_year | latest_refresh_date 
------------+---------------------
       2023 | 2025-09-03
(1 row)

Test 4: Load commissions data for year 2025, effective 2025-09-02. Ensure this load succeeds and does not affect the 2023 data.
Number of rows:
 num_rows 
----------
     2410
(1 row)

Latest refresh date by event year:
 event_year | latest_refresh_date 
------------+---------------------
       2023 | 2025-09-03
       2025 | 2025-09-02
(2 rows)

Test 5: Load commissions data for year 2024, effective 2025-09-04. Ensure this load succeeds and does not affect 2023 or 2025 data.
Number of rows:
 num_rows 
----------
     4364
(1 row)

Latest refresh date by event year:
 event_year | latest_refresh_date 
------------+---------------------
       2023 | 2025-09-03
       2024 | 2025-09-04
       2025 | 2025-09-02
(3 rows)

Tests completed.
